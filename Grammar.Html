<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ultimate Interactive Grammar Game</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<style>
/* -------------------- GLOBAL -------------------- */
*{box-sizing:border-box; margin:0; padding:0;}
body{
  font-family:'Poppins',sans-serif;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background: linear-gradient(135deg,#667eea,#764ba2);
  overflow:hidden;
}
.container{
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(15px);
  padding:40px;
  border-radius:25px;
  width:95%;
  max-width:950px;
  text-align:center;
  box-shadow:0 25px 60px rgba(0,0,0,0.3);
  position:relative;
  animation: fadeIn 1s ease forwards;
}

/* -------------------- HEADINGS -------------------- */
h1{
  font-weight:800;
  font-size:38px;
  background: linear-gradient(45deg,#ff6a00,#ee0979);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  margin-bottom:25px;
  animation: textGlow 2s infinite alternate;
}

/* -------------------- PAGES -------------------- */
.page{display:none; transition:all 0.5s;}
.page.active{display:block;}

/* -------------------- CARDS -------------------- */
.card{
  background: rgba(255,255,255,0.25);
  padding:25px;
  border-radius:18px;
  margin:15px 0;
  text-align:left;
  box-shadow:0 8px 20px rgba(0,0,0,0.15);
  border:1px solid rgba(255,255,255,0.3);
  transition:transform 0.3s, box-shadow 0.3s;
}
.card:hover{
  transform: translateY(-5px);
  box-shadow:0 15px 25px rgba(0,0,0,0.2);
}

/* -------------------- BUTTONS -------------------- */
.btn, .choice-btn{
  padding:16px 50px;
  font-size:20px;
  border:none;
  border-radius:50px;
  cursor:pointer;
  font-weight:700;
  transition:0.3s;
}
.btn{
  background: linear-gradient(45deg,#00c6ff,#0072ff);
  color:white;
  margin-top:30px;
}
.btn:hover{
  transform:scale(1.08);
  background: linear-gradient(45deg,#ff512f,#dd2476);
}
.choice-btn{
  background: linear-gradient(45deg,#43e97b,#38f9d7);
}
.choice-btn:hover{
  transform:scale(1.1);
  background: linear-gradient(45deg,#fa709a,#fee140);
}
.choice-btn:disabled{
  opacity:0.5;
  cursor:not-allowed;
}

/* -------------------- SENTENCE -------------------- */
.sentence{
  font-size:28px;
  margin:25px 0;
  color:#222;
  font-weight:600;
}
.blank{
  border-bottom:4px solid #7b2ff7;
  padding:2px 18px;
  min-width:80px;
  display:inline-block;
  font-weight:800;
  color:#7b2ff7;
  transition: all 0.3s;
}
.blank:hover{
  transform:scale(1.1);
  color:#ff6a00;
}

/* -------------------- FEEDBACK & SCORE -------------------- */
#feedback{
  font-weight:900;
  font-size:26px;
  margin-top:20px;
}
#score,#level{
  font-size:22px;
  font-weight:800;
  background: linear-gradient(45deg,#36d1dc,#5b86e5);
  color:white;
  padding:12px 24px;
  border-radius:30px;
  display:inline-block;
  margin:10px;
  position:relative;
}
.star-container{
  position:absolute;
  top:-25px;
  left:50%;
  transform:translateX(-50%);
}
.star{
  font-size:30px;
  display:inline-block;
  margin:0 2px;
  animation: bounce 0.5s ease;
}

/* -------------------- GHOST -------------------- */
.overlay{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:rgba(0,0,0,0.6);
  opacity:0;
  pointer-events:none;
  transition:0.3s;
}
.overlay.show{
  opacity:1;
  pointer-events:auto;
}
.ghost{
  font-size:140px;
  animation: ghostFloat 1s infinite alternate;
}

/* -------------------- PROGRESS -------------------- */
#progressBar{
  height:100%;
  width:0%;
  background: linear-gradient(45deg,#36d1dc,#5b86e5);
  border-radius:30px;
  transition:width 0.5s;
}

/* -------------------- ANIMATIONS -------------------- */
@keyframes bounce{
  0%{transform:translateY(0);}
  50%{transform:translateY(-15px);}
  100%{transform:translateY(0);}
}
@keyframes ghostFloat{
  0%{transform:translateY(0);}
  100%{transform:translateY(-20px);}
}
@keyframes fadeIn{
  0%{opacity:0; transform:translateY(30px);}
  100%{opacity:1; transform:translateY(0);}
}
@keyframes textGlow{
  0%{text-shadow:0 0 5px #fff;}
  100%{text-shadow:0 0 25px #fff;}
}
@keyframes shake{
  0%{transform: translateX(0);}
  25%{transform: translateX(-10px);}
  50%{transform: translateX(10px);}
  75%{transform: translateX(-10px);}
  100%{transform: translateX(0);}
}

/* -------------------- CONFETTI -------------------- */
canvas{
  position:fixed;
  top:0; left:0;
  pointer-events:none;
  width:100%;
  height:100%;
  z-index:999;
}
</style>
</head>
<body>
<div class="container">

<!-- PAGE 1 ‚Äì GRAMMAR -->
<div class="page active" id="page1">
<h1>üìò Grammar Basics</h1>
<div class="card">
<h2>IS / ARE</h2>
<p>Used in present tense.<br>
<b>IS</b> ‚Äì singular (one person/thing)<br>
<b>ARE</b> ‚Äì plural (more than one)<br>
Example: The boy is happy.<br>
The students are ready.
</p>
</div>
<div class="card">
<h2>WAS / WERE</h2>
<p>Used in past tense.<br>
<b>WAS</b> ‚Äì singular<br>
<b>WERE</b> ‚Äì plural<br>
Example: She was tired.<br>
They were excited.
</p>
</div>
<div class="card">
<h2>HAS / HAVE</h2>
<p>Used for possession or completed action.<br>
<b>HAS</b> ‚Äì singular<br>
<b>HAVE</b> ‚Äì plural<br>
Example: He has a book.<br>
They have activities.
</p>
</div>
<div class="card">
<h2>WILL BE</h2>
<p>Used in future tense.<br>
Example: The test will be tomorrow.
</p>
</div>
<button class="btn" onclick="goToPage(2)">Next ‚û°Ô∏è</button>
</div>

<!-- PAGE 2 ‚Äì INSTRUCTIONS -->
<div class="page" id="page2">
<h1>üìù Game Instructions</h1>
<div class="card">‚úÖ Read each sentence carefully.</div>
<div class="card">‚úÖ Each question has <b>6 choices</b>.</div>
<div class="card">‚úÖ Level 1‚Äì2: 1 blank<br>Level 3‚Äì5: 2 blanks<br>Level 6‚Äì10: 3 blanks</div>
<div class="card">‚úÖ Correct answer = +1 point per blank.</div>
<div class="card">‚úÖ Wrong answer = Ghost appears üëª.</div>
<div class="card">‚úÖ Complete all questions to see your final score.</div>
<button class="btn" onclick="goToPage(3)">Start Game üéÆ</button>
</div>

<!-- PAGE 3 ‚Äì GAME -->
<div class="page" id="page3">
<h1>üéÆ Grammar Challenge</h1>
<div id="level">Level 1</div>
<div id="score">Score: 0 / 0
<div class="star-container" id="stars"></div>
</div>

<!-- Progress Bar -->
<div style="background:#ddd; border-radius:30px; height:25px; width:100%; max-width:700px; margin:20px auto; overflow:hidden;">
  <div id="progressBar"></div>
</div>

<div class="sentence" id="sentence"></div>
<div class="buttons" id="choices"></div>
<div id="feedback"></div>
</div>

</div>

<!-- GHOST -->
<div class="overlay" id="ghost">
<div class="ghost">üëª</div>
</div>

<!-- CONFETTI CANVAS -->
<canvas id="confetti"></canvas>

<!-- SOUNDS -->
<audio id="clickSound" src="https://www.soundjay.com/button/sounds/button-16.mp3"></audio>
<audio id="correctSound" src="https://www.soundjay.com/button/sounds/button-4.mp3"></audio>
<audio id="wrongSound" src="https://www.soundjay.com/button/sounds/button-10.mp3"></audio>

<script>
// -------------------- PAGE NAVIGATION --------------------
function goToPage(n){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById("page"+n).classList.add("active");
}

// -------------------- QUESTIONS --------------------
let questions=[
  { text:"The boy <span class='blank' data-id='0'></span> happy yesterday.", answer:["was"], choices:["is","was","are","has","have","will be"] },
  { text:"They <span class='blank' data-id='0'></span> excited last night.", answer:["were"], choices:["is","are","was","were","have","will be"] },
  { text:"She <span class='blank' data-id='0'></span> a new phone and <span class='blank' data-id='1'></span> ready for school.", answer:["has","is"], choices:["is","are","was","were","has","have"] },
  { text:"We <span class='blank' data-id='0'></span> many projects to finish and <span class='blank' data-id='1'></span> going to the library.", answer:["have","are"], choices:["is","are","was","were","has","have"] },
  { text:"The students <span class='blank' data-id='0'></span> ready tomorrow and <span class='blank' data-id='1'></span> excited for the event.", answer:["will be","are"], choices:["is","are","was","were","has","will be"] },
  { text:"He <span class='blank' data-id='0'></span> tired, <span class='blank' data-id='1'></span> hungry, and <span class='blank' data-id='2'></span> thirsty.", answer:["is","is","is"], choices:["is","are","was","were","has","have"] },
  { text:"They <span class='blank' data-id='0'></span> students, <span class='blank' data-id='1'></span> ready, and <span class='blank' data-id='2'></span> excited.", answer:["are","are","are"], choices:["is","are","was","were","has","have"] },
  { text:"I <span class='blank' data-id='0'></span> a book, <span class='blank' data-id='1'></span> finished it, and <span class='blank' data-id='2'></span> happy.", answer:["have","have","am"], choices:["is","are","was","were","has","have","am"] },
  { text:"The teacher <span class='blank' data-id='0'></span> explaining, <span class='blank' data-id='1'></span> writing, and <span class='blank' data-id='2'></span> observing.", answer:["is","is","is"], choices:["is","are","was","were","has","have"] },
  { text:"Students <span class='blank' data-id='0'></span> learning, <span class='blank' data-id='1'></span> practicing, and <span class='blank' data-id='2'></span> enjoying.", answer:["are","are","are"], choices:["is","are","was","were","has","have"] }
];

let idx=0, score=0, currentBlank=0;
const sentenceEl=document.getElementById("sentence");
const choicesEl=document.getElementById("choices");
const feedbackEl=document.getElementById("feedback");
const levelEl=document.getElementById("level");
const scoreEl=document.getElementById("score");
const starsEl=document.getElementById("stars");
const ghost=document.getElementById("ghost");
const clickSound=document.getElementById("clickSound");
const correctSound=document.getElementById("correctSound");
const wrongSound=document.getElementById("wrongSound");
const progressBar=document.getElementById("progressBar");

// Total blanks
let totalBlanks = questions.reduce((sum, q)=>sum + q.answer.length, 0);

// -------------------- CONFETTI --------------------
const canvas=document.getElementById("confetti");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;
let confettiParticles=[];
function Confetti(){
  this.x=Math.random()*canvas.width;
  this.y=Math.random()*canvas.height-20;
  this.radius=Math.random()*6+4;
  this.color=`hsl(${Math.random()*360},100%,50%)`;
  this.speed=Math.random()*3+2;
  this.angle=Math.random()*Math.PI*2;
  this.update=function(){
    this.y+=this.speed;
    this.x+=Math.sin(this.angle)*2;
    if(this.y>canvas.height)this.y=0;
  };
  this.draw=function(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);
    ctx.fillStyle=this.color;
    ctx.fill();
  };
}
function spawnConfetti(){
  for(let i=0;i<100;i++){
    confettiParticles.push(new Confetti());
  }
  drawConfetti();
  setTimeout(()=>{confettiParticles=[];ctx.clearRect(0,0,canvas.width,canvas.height);},1500);
}
function drawConfetti(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  confettiParticles.forEach(p=>{p.update();p.draw();});
  if(confettiParticles.length>0)requestAnimationFrame(drawConfetti);
}

// -------------------- RENDER & CHOICES --------------------
function render(){
  let q=questions[idx];
  sentenceEl.innerHTML=q.text;
  levelEl.textContent="Level "+(idx+1);
  scoreEl.textContent=`Score: ${score} / ${totalBlanks}`;
  feedbackEl.textContent="";
  currentBlank=0;
  renderChoices(q);
}
function renderChoices(q){
  choicesEl.innerHTML="";
  let shuffled=[...q.choices].sort(()=>Math.random()-0.5);
  shuffled.forEach(c=>{
    let b=document.createElement("button");
    b.className="choice-btn";
    b.textContent=c;
    b.onclick=()=>check(c,b);
    choicesEl.appendChild(b);
  });
}

// -------------------- CHECK ANSWER --------------------
function check(choice, btn){
  clickSound.play();
  let q=questions[idx];
  let blanks=sentenceEl.querySelectorAll(".blank");

  blanks[currentBlank].textContent = choice;
  document.querySelectorAll(".choice-btn").forEach(b=>b.disabled=true);

  if(choice === q.answer[currentBlank]){
    score++;
    scoreEl.textContent=`Score: ${score} / ${totalBlanks}`;

    // Update progress bar
    let percent = Math.round((score/totalBlanks)*100);
    progressBar.style.width = percent+"%";

    // Add star
    let star=document.createElement("span");
    star.className="star";
    star.textContent="‚≠ê";
    starsEl.appendChild(star);

    feedbackEl.innerHTML="‚úÖ Correct!";
    correctSound.play();
    spawnConfetti();
  } else{
    feedbackEl.innerHTML="‚ùå Wrong!";
    wrongSound.play();
    ghost.classList.add("show");
    setTimeout(()=>ghost.classList.remove("show"),900);
  }

  currentBlank++;
  setTimeout(()=>{
    if(currentBlank>=q.answer.length){
      next();
    } else{
      renderChoices(q);
    }
  },1200);
}

// -------------------- NEXT QUESTION --------------------
function next(){
  idx++;
  if(idx >= questions.length){
    sentenceEl.innerHTML="üéâ Game Completed!";
    choicesEl.innerHTML="";
    
    let passScore = Math.ceil(totalBlanks * 0.7); // 70% passing
    if(score >= passScore){
      feedbackEl.innerHTML = `üéâ Congratulations! You passed! ‚úÖ<br>Final Score: ${score} / ${totalBlanks}`;
      spawnConfetti();
    } else {
      feedbackEl.innerHTML = `üí™ Better luck next time! Study hard! ‚ùå<br>Final Score: ${score} / ${totalBlanks}`;
      // shake animation
      sentenceEl.style.animation = "shake 0.5s";
      sentenceEl.addEventListener("animationend", () => {sentenceEl.style.animation="";});
    }
    progressBar.style.width="100%";
    return;
  }
  render();
}

render();
</script>
</body>
</html>